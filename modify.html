<!DOCTYPE html>

<head>
  <meta http-equiv="" Content-Type" content=" = " text/html; charset="utf-8">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="format-detection" content="telephone=no, email=no" />
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="HandheldFriendly" content="true">
  <meta name="MobileOptimized" content="320">
  <meta name="x5-orientation" content="portrait">
  <meta name="x5-fullscreen" content="true">
  <meta name="browsermode" content="application">
  <meta name="x5-page-mode" content="app">
  <meta name="msapplication-tap-highlight" content="no">
  <link rel="stylesheet" href="./css/index.css" type="text/css" />
  <link rel="stylesheet" href="./css/modify.css" type="text/css" />
  <title>Modify Task</title>
  <script src="js/audio.js"></script>

</head>

<body>
  <audio id="audio">
    <source src="sound.mp3" type="audio/mpeg">
  </audio>
  <header class="flex-sb">
    <p id="logo">E</p>
    <nav id="nav-bar" class="nav-link">
      <a href="index.html" class="nav-link">Easytask</a> |
      <a href="list.html" class="nav-link">Task-list</a> |
      <a href="my.html" class="nav-link">My</a> |
      <a href="login.html" class="nav-link">Login</a>
    </nav>

  </header>

  <div class="timer">
    <img id="lb" class="lb" src="img/lb1.png">
    <div>
      <a href="timer.html"><img src="icon/timer.png" width="50" /></a>
      <a href="note.html"><img src="icon/note.png" width="50" /></a>
    </div>
  </div>

  <center>
    <div class="title">Task List</div>
    <table id="list" width=60%>
      <th>name</th>
      <th>month</th>
      <th>date</th>
      <th>priority</th>
      <th>time</th>
    </table>
    <div class="title">To modify</div>
    <div class="my">
      <div class="title">Task name</div>
      <input type="text" id="name">
      <div class="title">Due Date:</div>
      <select id="month">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
      </select>
      <select id="date">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
      </select>
      <br>
      <div class="title">Pariority Rating:</div>
      <div class="radio-box">
        <label><span>High</span> <input style="width: auto;" type="radio" name="Pariority" value="High"
            id="High"></label>
        <label><span>Med</span> <input style="width: auto;" type="radio" name="Pariority" value="Med" id="Med"></label>
        <label><span>Low</span> <input style="width: auto;" type="radio" name="Pariority" value="Low" id="Low"></label>
      </div>
      <div class="title">Estimated Time To Complete:</div>
      <input type="text" id="time">
      <br><br>
      <p><button class="login_button" onclick="register_click()">Submit</button></p>
      <br>
    </div>
  </center>
  <script>
    var list = localStorage.getItem("list");
    var array = list.split(";");
    var content = document.getElementById("list").innerHTML.split("</tbody>")[0];
    for (var i = 0; i < array.length; i++) {
      var arr = array[i].split("-");
      if (typeof (arr[0]) != "undefined" && typeof (arr[1]) != "undefined" && typeof (arr[2]) != "undefined" && typeof (arr[3]) != "undefined" && typeof (arr[4]) != "undefined") {
        var tmp = "<tr>";
        tmp += "<td>" + arr[0] + "</td>";
        tmp += "<td>" + arr[1] + "</td>";
        tmp += "<td>" + arr[2] + "</td>";
        tmp += "<td>" + arr[3] + "</td>";
        tmp += "<td>" + arr[4] + "</td>";
        tmp += "</tr>"
        content += tmp;
      }
    }
    content += "</tbody></table>";
    document.getElementById("list").innerHTML = content;

    function justify_priority () {
      var priority;
      if (document.getElementById("High").checked) {
        priority = document.getElementById("High").value;
      }
      else if (document.getElementById("Med").checked) {
        priority = document.getElementById("Med").value;
      }
      else if (document.getElementById("Low").checked) {
        priority = document.getElementById("Low").value;
      }
      return priority;
    }

    function register_click () {

      var name = document.getElementById("name").value;
      var month = document.getElementById("month");
      var index = month.selectedIndex;
      var month = month.options[index].value;
      var date = document.getElementById("date");
      var index = date.selectedIndex;
      var date = date.options[index].value;
      var priority = justify_priority();
      var time = document.getElementById("time").value;

      var res = "" + name + "-" + month + "-" + date + "-" + priority + "-" + time + ";";
      var list = localStorage.getItem("list");
      if (list == null) {
        list = "";
      }
      var array = list.split(";");
      var newlist = "";
      for (var i = 0; i < array.length; i++) {
        var arr = array[i].split("-");
        if (typeof (arr[0]) != "undefined" && typeof (arr[1]) != "undefined" && typeof (arr[2]) != "undefined" && typeof (arr[3]) != "undefined" && typeof (arr[4]) != "undefined") {
          if (arr[0] == name) {
            newlist += res;
          }
          else {
            newlist += array[i] + ";";
          }
        }
      }
      localStorage.setItem("list", newlist);
      window.location.href = "modify.html";
    }
  </script>
</body>

</html>